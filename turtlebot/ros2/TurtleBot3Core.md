이 코드는 TurtleBot3 로봇의 핵심 기능들을 제어하는 `TurtleBot3Core` 클래스를 정의하고 있습니다. 이 클래스는 모터 드라이버, 센서, 조작 장치(매니퓰레이터) 드라이버, 진단, 컨트롤러 등 여러 하위 시스템의 초기화 및 운영을 담당합니다. 이 코드는 또한 ROS2 노드와의 통신, 모터 제어, 센서 데이터 처리 등의 기능을 포함합니다.

### 코드 구조 및 주요 함수

1. **TurtleBot3 모델 정보 (`TB3ModelInfo` 구조체):**
   - TurtleBot3의 다양한 모델(예: Burger, Waffle)에 대한 정보를 저장합니다. 이 정보에는 휠 반경, 휠 간 거리, 회전 반경, 로봇 반경, 매니퓰레이터 존재 여부 등이 포함됩니다.

2. **초기화 및 실행 (`begin`, `run` 함수):**
   - `begin`: 로봇의 초기 설정을 수행합니다. 모터, 센서, 진단 시스템, 컨트롤러 등을 초기화하고, ROS2 노드와의 통신을 설정합니다.
   - `run`: 로봇의 주요 루프를 실행합니다. 이는 센서 데이터 처리, 모터 제어, ROS2 노드와의 통신 등을 포함합니다.

3. **Dynamixel 슬레이브 기능 (`dxl_slave_write_callback_func` 함수):**
   - Dynamixel 슬레이브 기능을 통해 ROS2 노드로부터 명령을 받고, 로봇의 상태 정보를 ROS2 노드에 전송합니다.

4. **센서 및 모터 업데이트 함수:**
   - `update_imu`, `update_times`, `update_gpios`, `update_motor_status`, `update_battery_status`, `update_analog_sensors`, `update_joint_status`: 로봇의 다양한 센서 및 모터 상태를 주기적으로 업데이트합니다.

5. **ROS2 노드 연결 상태 관리 (`get_connection_state_with_ros2_node`, `set_connection_state_with_ros2_node`, `update_connection_state_with_ros2_node` 함수):**
   - ROS2 노드와의 연결 상태를 확인하고, 연결 상태가 변경되었을 때 필요한 처리를 수행합니다.

6. **모터 테스트 (`test_motors_with_buttons` 함수):**
   - 빌트인 버튼을 사용하여 모터를 간단하게 테스트할 수 있는 기능을 제공합니다.

### 코드의 특징 및 주요 포인트

- **모듈성과 확장성**: 이 코드는 모터, 센서, ROS2 노드와의 통신 등 로봇의 다양한 구성 요소를 모듈화하여 관리합니다. 이를 통해 코드의 유지 보수와 확장이 용이합니다.
- **ROS2 통합**: 코드는 ROS2 노드와의 통신을 위한 여러 기능을 포함하고 있어, 로봇과 ROS2 기반 시스템 간의 상호 작용을 지원합니다.
- **센서 데이터 처리**: 다양한 센서(예: IMU, 조도 센서, 적외선 센서, 초음파 센서)로부터 데이터를 수집하고 처리하는 코드를 포함합니다.
- **모터 제어**: 휠 및 매니퓰레이터의 모터를 제어하기 위한 다양한 함수를 포함합니다.

이 코드는 TurtleBot3 로봇을 효과적으로 제어하고, 외부 시스템(예: ROS2 노드)과 통신할 수 있는 기능을 제공합니다

. 로봇의 다양한 기능과 행동을 프로그래밍하고, 센서 데이터를 처리하며, 외부 명령에 반응할 수 있도록 설계되었습니다.
